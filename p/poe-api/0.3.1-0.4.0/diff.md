# Comparing `tmp/poe_api-0.3.1-py3-none-any.whl.zip` & `tmp/poe_api-0.4.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,42 +1,43 @@
-Zip file size: 37114 bytes, number of entries: 40
--rw-r--r--  2.0 unx    16891 b- defN 23-Apr-22 02:50 poe.py
--rw-r--r--  2.0 unx     1093 b- defN 23-Apr-08 20:17 poe_graphql/AddHumanMessageMutation.graphql
--rw-r--r--  2.0 unx      373 b- defN 23-Apr-08 20:17 poe_graphql/AddMessageBreakMutation.graphql
--rw-r--r--  2.0 unx      180 b- defN 23-Apr-08 20:17 poe_graphql/AutoSubscriptionMutation.graphql
--rw-r--r--  2.0 unx       97 b- defN 23-Apr-08 20:17 poe_graphql/BioFragment.graphql
--rw-r--r--  2.0 unx       73 b- defN 23-Apr-08 20:17 poe_graphql/ChatAddedSubscription.graphql
--rw-r--r--  2.0 unx      100 b- defN 23-Apr-08 20:17 poe_graphql/ChatFragment.graphql
--rw-r--r--  2.0 unx     6971 b- defN 23-Apr-08 20:17 poe_graphql/ChatListPaginationQuery.graphql
--rw-r--r--  2.0 unx      686 b- defN 23-Apr-08 20:17 poe_graphql/ChatPaginationQuery.graphql
--rw-r--r--  2.0 unx      154 b- defN 23-Apr-08 20:17 poe_graphql/ChatViewQuery.graphql
--rw-r--r--  2.0 unx      160 b- defN 23-Apr-08 20:17 poe_graphql/DeleteHumanMessagesMutation.graphql
--rw-r--r--  2.0 unx      123 b- defN 23-Apr-08 20:17 poe_graphql/DeleteMessageMutation.graphql
--rw-r--r--  2.0 unx      103 b- defN 23-Apr-08 20:17 poe_graphql/HandleFragment.graphql
--rw-r--r--  2.0 unx      306 b- defN 23-Apr-08 20:17 poe_graphql/LoginWithVerificationCodeMutation.graphql
--rw-r--r--  2.0 unx     1885 b- defN 23-Apr-08 20:17 poe_graphql/MessageAddedSubscription.graphql
--rw-r--r--  2.0 unx      135 b- defN 23-Apr-08 20:17 poe_graphql/MessageDeletedSubscription.graphql
--rw-r--r--  2.0 unx      194 b- defN 23-Apr-08 20:17 poe_graphql/MessageFragment.graphql
--rw-r--r--  2.0 unx      145 b- defN 23-Apr-08 20:17 poe_graphql/MessageRemoveVoteMutation.graphql
--rw-r--r--  2.0 unx      216 b- defN 23-Apr-08 20:17 poe_graphql/MessageSetVoteMutation.graphql
--rw-r--r--  2.0 unx     1670 b- defN 23-Apr-17 06:22 poe_graphql/PoeBotCreateMutation.graphql
--rw-r--r--  2.0 unx      841 b- defN 23-Apr-17 07:15 poe_graphql/PoeBotEditMutation.graphql
--rw-r--r--  2.0 unx      710 b- defN 23-Apr-08 20:17 poe_graphql/SendMessageMutation.graphql
--rw-r--r--  2.0 unx      263 b- defN 23-Apr-08 20:17 poe_graphql/SendVerificationCodeForLoginMutation.graphql
--rw-r--r--  2.0 unx      213 b- defN 23-Apr-08 20:17 poe_graphql/ShareMessagesMutation.graphql
--rw-r--r--  2.0 unx      308 b- defN 23-Apr-08 20:17 poe_graphql/SignupWithVerificationCodeMutation.graphql
--rw-r--r--  2.0 unx      159 b- defN 23-Apr-08 20:17 poe_graphql/StaleChatUpdateMutation.graphql
--rw-r--r--  2.0 unx      162 b- defN 23-Apr-08 20:17 poe_graphql/SubscriptionsMutation.graphql
--rw-r--r--  2.0 unx       95 b- defN 23-Apr-08 20:17 poe_graphql/SummarizePlainPostQuery.graphql
--rw-r--r--  2.0 unx      147 b- defN 23-Apr-08 20:17 poe_graphql/SummarizeQuotePostQuery.graphql
--rw-r--r--  2.0 unx      180 b- defN 23-Apr-08 20:17 poe_graphql/SummarizeSharePostQuery.graphql
--rw-r--r--  2.0 unx      368 b- defN 23-Apr-08 20:17 poe_graphql/UserSnippetFragment.graphql
--rw-r--r--  2.0 unx      400 b- defN 23-Apr-08 20:17 poe_graphql/ViewerInfoQuery.graphql
--rw-r--r--  2.0 unx     1038 b- defN 23-Apr-08 20:17 poe_graphql/ViewerStateFragment.graphql
--rw-r--r--  2.0 unx      657 b- defN 23-Apr-08 20:17 poe_graphql/ViewerStateUpdatedSubscription.graphql
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-08 20:17 poe_graphql/__init__.py
--rw-r--r--  2.0 unx    35149 b- defN 23-Apr-22 02:55 poe_api-0.3.1.dist-info/LICENSE
--rw-r--r--  2.0 unx    14177 b- defN 23-Apr-22 02:55 poe_api-0.3.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-22 02:55 poe_api-0.3.1.dist-info/WHEEL
--rw-r--r--  2.0 unx       16 b- defN 23-Apr-22 02:55 poe_api-0.3.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3759 b- defN 23-Apr-22 02:55 poe_api-0.3.1.dist-info/RECORD
-40 files, 90289 bytes uncompressed, 30916 bytes compressed:  65.8%
+Zip file size: 39114 bytes, number of entries: 41
+-rw-r--r--  2.0 unx    19184 b- defN 23-May-28 02:21 poe.py
+-rw-r--r--  2.0 unx     1093 b- defN 23-May-27 23:16 poe_graphql/AddHumanMessageMutation.graphql
+-rw-r--r--  2.0 unx      373 b- defN 23-May-27 23:16 poe_graphql/AddMessageBreakMutation.graphql
+-rw-r--r--  2.0 unx      180 b- defN 23-May-27 23:16 poe_graphql/AutoSubscriptionMutation.graphql
+-rw-r--r--  2.0 unx       97 b- defN 23-May-27 23:16 poe_graphql/BioFragment.graphql
+-rw-r--r--  2.0 unx       73 b- defN 23-May-27 23:16 poe_graphql/ChatAddedSubscription.graphql
+-rw-r--r--  2.0 unx      100 b- defN 23-May-27 23:16 poe_graphql/ChatFragment.graphql
+-rw-r--r--  2.0 unx     6971 b- defN 23-May-27 23:16 poe_graphql/ChatListPaginationQuery.graphql
+-rw-r--r--  2.0 unx      686 b- defN 23-May-27 23:16 poe_graphql/ChatPaginationQuery.graphql
+-rw-r--r--  2.0 unx      154 b- defN 23-May-27 23:16 poe_graphql/ChatViewQuery.graphql
+-rw-r--r--  2.0 unx      160 b- defN 23-May-27 23:16 poe_graphql/DeleteHumanMessagesMutation.graphql
+-rw-r--r--  2.0 unx      123 b- defN 23-May-27 23:16 poe_graphql/DeleteMessageMutation.graphql
+-rw-r--r--  2.0 unx     1083 b- defN 23-May-27 23:37 poe_graphql/ExploreBotsListPaginationQuery.graphql
+-rw-r--r--  2.0 unx      103 b- defN 23-May-27 23:16 poe_graphql/HandleFragment.graphql
+-rw-r--r--  2.0 unx      306 b- defN 23-May-27 23:16 poe_graphql/LoginWithVerificationCodeMutation.graphql
+-rw-r--r--  2.0 unx     1885 b- defN 23-May-27 23:16 poe_graphql/MessageAddedSubscription.graphql
+-rw-r--r--  2.0 unx      135 b- defN 23-May-27 23:16 poe_graphql/MessageDeletedSubscription.graphql
+-rw-r--r--  2.0 unx      194 b- defN 23-May-27 23:16 poe_graphql/MessageFragment.graphql
+-rw-r--r--  2.0 unx      145 b- defN 23-May-27 23:16 poe_graphql/MessageRemoveVoteMutation.graphql
+-rw-r--r--  2.0 unx      216 b- defN 23-May-27 23:16 poe_graphql/MessageSetVoteMutation.graphql
+-rw-r--r--  2.0 unx     1670 b- defN 23-May-27 23:16 poe_graphql/PoeBotCreateMutation.graphql
+-rw-r--r--  2.0 unx      841 b- defN 23-May-27 23:16 poe_graphql/PoeBotEditMutation.graphql
+-rw-r--r--  2.0 unx      710 b- defN 23-May-27 23:16 poe_graphql/SendMessageMutation.graphql
+-rw-r--r--  2.0 unx      263 b- defN 23-May-27 23:16 poe_graphql/SendVerificationCodeForLoginMutation.graphql
+-rw-r--r--  2.0 unx      213 b- defN 23-May-27 23:16 poe_graphql/ShareMessagesMutation.graphql
+-rw-r--r--  2.0 unx      308 b- defN 23-May-27 23:16 poe_graphql/SignupWithVerificationCodeMutation.graphql
+-rw-r--r--  2.0 unx      159 b- defN 23-May-27 23:16 poe_graphql/StaleChatUpdateMutation.graphql
+-rw-r--r--  2.0 unx      162 b- defN 23-May-27 23:16 poe_graphql/SubscriptionsMutation.graphql
+-rw-r--r--  2.0 unx       95 b- defN 23-May-27 23:16 poe_graphql/SummarizePlainPostQuery.graphql
+-rw-r--r--  2.0 unx      147 b- defN 23-May-27 23:16 poe_graphql/SummarizeQuotePostQuery.graphql
+-rw-r--r--  2.0 unx      180 b- defN 23-May-27 23:16 poe_graphql/SummarizeSharePostQuery.graphql
+-rw-r--r--  2.0 unx      368 b- defN 23-May-27 23:16 poe_graphql/UserSnippetFragment.graphql
+-rw-r--r--  2.0 unx      400 b- defN 23-May-27 23:16 poe_graphql/ViewerInfoQuery.graphql
+-rw-r--r--  2.0 unx     1038 b- defN 23-May-27 23:16 poe_graphql/ViewerStateFragment.graphql
+-rw-r--r--  2.0 unx      657 b- defN 23-May-27 23:16 poe_graphql/ViewerStateUpdatedSubscription.graphql
+-rw-r--r--  2.0 unx        0 b- defN 23-May-27 23:16 poe_graphql/__init__.py
+-rw-r--r--  2.0 unx    35149 b- defN 23-May-28 03:21 poe_api-0.4.0.dist-info/LICENSE
+-rw-r--r--  2.0 unx    16887 b- defN 23-May-28 03:21 poe_api-0.4.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-May-28 03:21 poe_api-0.4.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx       16 b- defN 23-May-28 03:21 poe_api-0.4.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3866 b- defN 23-May-28 03:21 poe_api-0.4.0.dist-info/RECORD
+41 files, 96482 bytes uncompressed, 32740 bytes compressed:  66.1%
```

## zipnote {}

```diff
@@ -30,14 +30,17 @@
 
 Filename: poe_graphql/DeleteHumanMessagesMutation.graphql
 Comment: 
 
 Filename: poe_graphql/DeleteMessageMutation.graphql
 Comment: 
 
+Filename: poe_graphql/ExploreBotsListPaginationQuery.graphql
+Comment: 
+
 Filename: poe_graphql/HandleFragment.graphql
 Comment: 
 
 Filename: poe_graphql/LoginWithVerificationCodeMutation.graphql
 Comment: 
 
 Filename: poe_graphql/MessageAddedSubscription.graphql
@@ -99,23 +102,23 @@
 
 Filename: poe_graphql/ViewerStateUpdatedSubscription.graphql
 Comment: 
 
 Filename: poe_graphql/__init__.py
 Comment: 
 
-Filename: poe_api-0.3.1.dist-info/LICENSE
+Filename: poe_api-0.4.0.dist-info/LICENSE
 Comment: 
 
-Filename: poe_api-0.3.1.dist-info/METADATA
+Filename: poe_api-0.4.0.dist-info/METADATA
 Comment: 
 
-Filename: poe_api-0.3.1.dist-info/WHEEL
+Filename: poe_api-0.4.0.dist-info/WHEEL
 Comment: 
 
-Filename: poe_api-0.3.1.dist-info/top_level.txt
+Filename: poe_api-0.4.0.dist-info/top_level.txt
 Comment: 
 
-Filename: poe_api-0.3.1.dist-info/RECORD
+Filename: poe_api-0.4.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## poe.py

```diff
@@ -1,35 +1,32 @@
-import requests, re, json, random, logging, time, queue, threading, traceback, hashlib, string, random
-import requests.adapters
+import re, json, random, logging, time, queue, threading, traceback, hashlib, string, random, os
+import tls_client as requests
+import secrets
 import websocket
+import uuid
 from pathlib import Path
 from urllib.parse import urlparse
 
 parent_path = Path(__file__).resolve().parent
 queries_path = parent_path / "poe_graphql"
 queries = {}
 
 logging.basicConfig()
 logger = logging.getLogger()
 
 user_agent = "This will be ignored! See the README for info on how to set custom headers."
 headers = {
-  "User-Agent": "Mozilla/5.0 (X11; CrOS x86_64 14541.0.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36",
-  "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7",
+  "User-Agent": "Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0",
+  "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8",
   "Accept-Encoding": "gzip, deflate, br",
-  "Accept-Language": "en-US,en;q=0.9,und;q=0.8,af;q=0.7",
-  "Cache-Control": "no-cache",
-  "Dnt": "1",
-  "Pragma": "no-cache",
-  "Sec-Ch-Ua": "\"Google Chrome\";v=\"111\", \"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"111\"",
-  "Sec-Ch-Ua-Mobile": "?0",
-  "Sec-Ch-Ua-Platform": "\"Chrome OS\"",
-  "Sec-Gpc": "1",
+  "Accept-Language": "en-US,en;q=0.5",
+  "Te": "trailers",
   "Upgrade-Insecure-Requests": "1"
 }
+client_identifier = "firefox_102"
 
 def load_queries():
   for path in queries_path.iterdir():
     if path.suffix != ".graphql":
       continue
     with open(path) as f:
       queries[path.stem] = f.read()
@@ -43,30 +40,69 @@
 def request_with_retries(method, *args, **kwargs):
   attempts = kwargs.get("attempts") or 10
   url = args[0]
   for i in range(attempts):
     r = method(*args, **kwargs)
     if r.status_code == 200:
       return r
+    if r.status_code == 307:
+      if r.headers.get("Location").startswith("/login"):
+        raise RuntimeError("Invalid or missing token.")
     logger.warn(f"Server returned a status code of {r.status_code} while downloading {url}. Retrying ({i+1}/{attempts})...")
   
   raise RuntimeError(f"Failed to download {url} too many times.")
 
+def generate_nonce(length:int=16):
+  return "".join(secrets.choice(string.ascii_letters + string.digits) for i in range(length))
+
+def get_config_path():
+  if os.name == "nt":
+    return Path.home() / "AppData" / "Roaming" / "poe-api"
+  return Path.home() / ".config" / "poe-api"
+
+def set_saved_device_id(user_id, device_id):
+  device_id_path = get_config_path() / "device_id.json"
+  device_ids = {}
+  if device_id_path.exists():
+    with open(device_id_path) as f:
+      device_ids = json.loads(f.read())
+  
+  device_ids[user_id] = device_id
+  device_id_path.parent.mkdir(parents=True, exist_ok=True)
+  with open(device_id_path, "w") as f:
+    f.write(json.dumps(device_ids, indent=2))
+
+def get_saved_device_id(user_id):
+  device_id_path = get_config_path() / "device_id.json"
+  device_ids = {}
+  if device_id_path.exists():
+    with open(device_id_path) as f:
+      device_ids = json.loads(f.read())
+  
+  if user_id in device_ids:
+    return device_ids[user_id]
+  
+  device_id = str(uuid.uuid4())
+  device_ids[user_id] = device_id
+  device_id_path.parent.mkdir(parents=True, exist_ok=True)
+  with open(device_id_path, "w") as f:
+    f.write(json.dumps(device_ids, indent=2))
+  
+  return device_id
+
 class Client:
   gql_url = "https://poe.com/api/gql_POST"
   gql_recv_url = "https://poe.com/api/receive_POST"
   home_url = "https://poe.com"
   settings_url = "https://poe.com/api/settings"
   
-  def __init__(self, token, proxy=None, headers=headers):
+  def __init__(self, token, proxy=None, headers=headers, device_id=None, client_identifier=client_identifier):
+    self.device_id = device_id
     self.proxy = proxy
-    self.session = requests.Session()
-    self.adapter = requests.adapters.HTTPAdapter(pool_connections=100, pool_maxsize=100)
-    self.session.mount("http://", self.adapter)
-    self.session.mount("https://", self.adapter)
+    self.session = requests.Session(client_identifier=client_identifier)
         
     if proxy:
       self.session.proxies = {
         "http": self.proxy,
         "https": self.proxy
       }
       logger.info(f"Proxy enabled: {self.proxy}")
@@ -91,20 +127,28 @@
   def setup_connection(self):
     self.ws_domain = f"tch{random.randint(1, 1e6)}"
     self.next_data = self.get_next_data(overwrite_vars=True)
     self.channel = self.get_channel_data()
     self.bots = self.get_bots(download_next_data=False)
     self.bot_names = self.get_bot_names()
 
+    if self.device_id is None:
+      self.device_id = self.get_device_id()
+
     self.gql_headers = {
       "poe-formkey": self.formkey,
       "poe-tchannel": self.channel["channel"],
     }
     self.gql_headers = {**self.gql_headers, **self.headers}
     self.subscribe()
+  
+  def get_device_id(self):
+    user_id = self.viewer["poeUser"]["id"]
+    device_id = get_saved_device_id(user_id)
+    return device_id
     
   def extract_formkey(self, html):
     script_regex = r'<script>if\(.+\)throw new Error;(.+)</script>'
     script_text = re.search(script_regex, html).group(1)
     key_regex = r'var .="([0-9a-f]+)",'
     key_text = re.search(key_regex, script_text).group(1)
     cipher_regex = r'.\[(\d+)\]=.\[(\d+)\]'
@@ -125,16 +169,17 @@
     json_regex = r'<script id="__NEXT_DATA__" type="application\/json">(.+?)</script>'
     json_text = re.search(json_regex, r.text).group(1)
     next_data = json.loads(json_text)
 
     if overwrite_vars:
       self.formkey = self.extract_formkey(r.text)
       self.viewer = next_data["props"]["pageProps"]["payload"]["viewer"]
+      self.user_id = self.viewer["poeUser"]["id"]
       self.next_data = next_data
-    
+
     return next_data
   
   def get_bot(self, display_name):
     url = f'https://poe.com/_next/data/{self.next_data["buildId"]}/{display_name}.json'
     
     r = request_with_retries(self.session.get, url)
 
@@ -175,14 +220,40 @@
   def get_bot_names(self):
     bot_names = {}
     for bot_nickname in self.bots:
       bot_obj = self.bots[bot_nickname]["defaultBotObject"]
       bot_names[bot_nickname] = bot_obj["displayName"]
     return bot_names
   
+  def explore_bots(self, end_cursor=None, count=25):
+    if not end_cursor:
+      url = f'https://poe.com/_next/data/{self.next_data["buildId"]}/explore_bots.json'
+      r = request_with_retries(self.session.get, url)
+      nodes = r.json()["pageProps"]["payload"]["exploreBotsConnection"]["edges"]
+      bots = [node["node"] for node in nodes]
+      bots = bots[:count]
+      return {
+        "bots": bots,
+        "end_cursor": r.json()["pageProps"]["payload"]["exploreBotsConnection"]["pageInfo" ]["endCursor"],
+      }
+
+    else:
+      # Use graphql to get the next page
+      result = self.send_query("ExploreBotsListPaginationQuery", {
+        "count": count, 
+        "cursor": end_cursor
+      })
+      result = result["data"]["exploreBotsConnection"]
+
+      bots = [node["node"] for node in result["edges"]]
+      return {
+        "bots": bots,
+        "end_cursor": result["pageInfo"]["endCursor"],
+      }
+  
   def get_remaining_messages(self, chatbot):
     chat_data = self.get_bot(self.bot_names[chatbot])
     return chat_data["defaultBotObject"]["messageLimit"]["numMessagesRemaining"]
       
   def get_channel_data(self, channel=None):
     logger.info("Downloading channel data...")
     r = request_with_retries(self.session.get, self.settings_url)
@@ -307,82 +378,89 @@
 
     except Exception:
       logger.error(traceback.format_exc())
       self.disconnect_ws()
       self.connect_ws()
 
   def send_message(self, chatbot, message, with_chat_break=False, timeout=20):
-    #if there is another active message, wait until it has finished sending
+    # if there is another active message, wait until it has finished sending
     while None in self.active_messages.values():
       time.sleep(0.01)
 
-    #None indicates that a message is still in progress
+    # None indicates that a message is still in progress
     self.active_messages["pending"] = None
 
     logger.info(f"Sending message to {chatbot}: {message}")
-    
-    #reconnect websocket
+
+    # reconnect websocket
     if not self.ws_connected:
       self.disconnect_ws()
       self.setup_connection()
       self.connect_ws()
+    
+    if chatbot in self.bots:
+      chat_id = self.bots[chatbot]["chatId"]
+    else:
+      chat_id = self.get_bot(chatbot)["chatId"]
 
     message_data = self.send_query("SendMessageMutation", {
       "bot": chatbot,
       "query": message,
-      "chatId": self.bots[chatbot]["chatId"],
+      "chatId": chat_id,
       "source": None,
-      "withChatBreak": with_chat_break
+      "clientNonce": generate_nonce(),
+      "sdid": self.device_id,
+      "withChatBreak": with_chat_break,
     })
     del self.active_messages["pending"]
-    
+
     if not message_data["data"]["messageEdgeCreate"]["message"]:
       raise RuntimeError(f"Daily limit reached for {chatbot}.")
     try:
       human_message = message_data["data"]["messageEdgeCreate"]["message"]
       human_message_id = human_message["node"]["messageId"]
     except TypeError:
       raise RuntimeError(f"An unknown error occured. Raw response data: {message_data}")
 
-    #indicate that the current message is waiting for a response
+    # indicate that the current message is waiting for a response
     self.active_messages[human_message_id] = None
     self.message_queues[human_message_id] = queue.Queue()
 
     last_text = ""
     message_id = None
     while True:
       try:
         message = self.message_queues[human_message_id].get(timeout=timeout)
       except queue.Empty:
         del self.active_messages[human_message_id]
         del self.message_queues[human_message_id]
         raise RuntimeError("Response timed out.")
-      
+
       #only break when the message is marked as complete
       if message["state"] == "complete":
         if last_text and message["messageId"] == message_id:
           break
         else:
           continue
-      
+
       #update info about response
-      message["text_new"] = message["text"][len(last_text):]
+      message["text_new"] = message["text"][len(last_text) :]
       last_text = message["text"]
       message_id = message["messageId"]
 
       yield message
-    
+
     del self.active_messages[human_message_id]
     del self.message_queues[human_message_id]
   
   def send_chat_break(self, chatbot):
     logger.info(f"Sending chat break to {chatbot}")
     result = self.send_query("AddMessageBreakMutation", {
-      "chatId": self.bots[chatbot]["chatId"]
-    })
+      "chatId": self.bots[chatbot]["chatId"]}
+    )
     return result["data"]["messageBreakCreate"]["message"]
 
   def get_message_history(self, chatbot, count=25, cursor=None):
     logger.info(f"Downloading {count} messages from {chatbot}")
 
     messages = []
     if cursor == None:
@@ -435,62 +513,63 @@
         message_ids.append(message["node"]["messageId"])
 
       self.delete_message(message_ids)
             
       if count == 0:
         return
       last_messages = self.get_message_history(chatbot, count=50)[::-1]
+      
     logger.info(f"No more messages left to delete.")
 
   def create_bot(self, handle, prompt="", base_model="chinchilla", description="", 
-                 intro_message="", api_key=None, api_bot=False, api_url=None,
-                 prompt_public=True, pfp_url=None, linkification=False,
-                 markdown_rendering=True, suggested_replies=False, private=False):
+                  intro_message="", api_key=None, api_bot=False, api_url=None,
+                  prompt_public=True, pfp_url=None, linkification=False,
+                  markdown_rendering=True, suggested_replies=False, private=False):
     result = self.send_query("PoeBotCreateMutation", {
-        "model": base_model,
-        "handle": handle,
-        "prompt": prompt,
-        "isPromptPublic": prompt_public,
-        "introduction": intro_message,
-        "description": description,
-        "profilePictureUrl": pfp_url,
-        "apiUrl": api_url,
-        "apiKey": api_key,
-        "isApiBot": api_bot,
-        "hasLinkification": linkification,
-        "hasMarkdownRendering": markdown_rendering,
-        "hasSuggestedReplies": suggested_replies,
-        "isPrivateBot": private
+      "model": base_model,
+      "handle": handle,
+      "prompt": prompt,
+      "isPromptPublic": prompt_public,
+      "introduction": intro_message,
+      "description": description,
+      "profilePictureUrl": pfp_url,
+      "apiUrl": api_url,
+      "apiKey": api_key,
+      "isApiBot": api_bot,
+      "hasLinkification": linkification,
+      "hasMarkdownRendering": markdown_rendering,
+      "hasSuggestedReplies": suggested_replies,
+      "isPrivateBot": private
     })
 
     data = result["data"]["poeBotCreate"]
     if data["status"] != "success":
       raise RuntimeError(f"Poe returned an error while trying to create a bot: {data['status']}")
     self.get_bots()
     return data
 
   def edit_bot(self, bot_id, handle, prompt="", base_model="chinchilla", description="", 
-                 intro_message="", api_key=None, api_url=None, private=False,
-                 prompt_public=True, pfp_url=None, linkification=False,
-                 markdown_rendering=True, suggested_replies=False):
+                intro_message="", api_key=None, api_url=None, private=False,
+                prompt_public=True, pfp_url=None, linkification=False,
+                markdown_rendering=True, suggested_replies=False):
     result = self.send_query("PoeBotEditMutation", {
-        "baseBot": base_model,
-        "botId": bot_id,
-        "handle": handle,
-        "prompt": prompt,
-        "isPromptPublic": prompt_public,
-        "introduction": intro_message,
-        "description": description,
-        "profilePictureUrl": pfp_url,
-        "apiUrl": api_url,
-        "apiKey": api_key,
-        "hasLinkification": linkification,
-        "hasMarkdownRendering": markdown_rendering,
-        "hasSuggestedReplies": suggested_replies,
-        "isPrivateBot": private
+      "baseBot": base_model,
+      "botId": bot_id,
+      "handle": handle,
+      "prompt": prompt,
+      "isPromptPublic": prompt_public,
+      "introduction": intro_message,
+      "description": description,
+      "profilePictureUrl": pfp_url,
+      "apiUrl": api_url,
+      "apiKey": api_key,
+      "hasLinkification": linkification,
+      "hasMarkdownRendering": markdown_rendering,
+      "hasSuggestedReplies": suggested_replies,
+      "isPrivateBot": private
     })
 
     data = result["data"]["poeBotEdit"]
     if data["status"] != "success":
       raise RuntimeError(f"Poe returned an error while trying to edit a bot: {data['status']}")
     self.get_bots()
     return data
```

## Comparing `poe_api-0.3.1.dist-info/LICENSE` & `poe_api-0.4.0.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `poe_api-0.3.1.dist-info/METADATA` & `poe_api-0.4.0.dist-info/METADATA`

 * *Files 12% similar despite different names*

```diff
@@ -1,47 +1,50 @@
 Metadata-Version: 2.1
 Name: poe-api
-Version: 0.3.1
+Version: 0.4.0
 Summary: A reverse engineered API wrapper for Quora's Poe
 Home-page: https://github.com/ading2210/poe-api
 Author: ading2210
 License: GPLv3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License (GPL)
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.7
 Description-Content-Type: text/markdown
 Requires-Dist: python-socks
 Requires-Dist: requests[socks]
+Requires-Dist: tls-client
 Requires-Dist: websocket-client
 
 # Python Poe API
 
 [![PyPi Version](https://img.shields.io/pypi/v/poe-api.svg)](https://pypi.org/project/poe-api/)
 
-This is a reverse engineered API wrapper for Quora's Poe, which allows you free access to OpenAI's ChatGPT and GPT-4, as well as Antropic's Claude.
+This is a reverse engineered API wrapper for Quora's Poe, which allows you free access to OpenAI's ChatGPT and GPT-4, as well as Anthropic's Claude.
 
 ## Table of Contents:
 - [Features](#features)
 - [Installation](#installation)
 - [Documentation](#documentation)
   * [Finding Your Token](#finding-your-token)
   * [Using the Client](#using-the-client)
     + [Downloading the Available Bots](#downloading-the-available-bots)
+    + [Using 3rd Party Bots](#using-3rd-party-bots)
     + [Creating New Bots](#creating-new-bots)
     + [Editing a Bot](#editing-a-bot)
     + [Sending Messages](#sending-messages)
     + [Clearing the Conversation Context](#clearing-the-conversation-context)
     + [Downloading Conversation History](#downloading-conversation-history)
     + [Deleting Messages](#deleting-messages)
     + [Purging a Conversation](#purging-a-conversation)
   * [Misc](#misc)
     + [Changing the Logging Level](#changing-the-logging-level)
     + [Setting a Custom User-Agent](#setting-a-custom-user-agent)
+    + [Setting a Custom Device ID](#setting-a-custom-device-id)
 - [Copyright](#copyright)
   * [Copyright Notice](#copyright-notice)
 
 *Table of contents generated with [markdown-toc](http://ecotrust-canada.github.io/markdown-toc).*
 
 ## Features:
  - Log in with token
@@ -71,40 +74,85 @@
  - Chromium: Devtools > Application > Cookies > poe.com
  - Firefox: Devtools > Storage > Cookies
  - Safari: Devtools > Storage > Cookies
 
 ### Using the Client:
 To use this library, simply import `poe` and create a `poe.Client` instance. The Client class accepts the following arguments:
  - `token` - The token to use. 
- - `proxy = None` - The proxy to use, in the format `protocol://host:port`. The socks5/socks4 protocol is reccommended.
+ - `proxy = None` - The proxy to use, in the format `protocol://host:port`. The `socks5h` protocol is recommended, as it also proxies the DNS queries.
+ - `device_id = None` - The device ID to use. If this is not specified, it will be randomly generated and stored on the disk. 
+ - `headers = headers` - The headers to use. This defaults to the headers specified in `poe.headers`.
+ - `client_identifier = client_identifier` - The client identifier that will be passed into the TLS client library. This defaults to the one specified in `poe.client_identifier`.
 
 Regular Example:
 ```python
 import poe
 client = poe.Client("TOKEN_HERE")
 ```
 
 Proxied Example:
 ```python
 import poe
-client = poe.Client("TOKEN_HERE", proxy="socks5://178.62.100.151:59166")
+client = poe.Client("TOKEN_HERE", proxy="socks5h://178.62.100.151:59166")
 ```
 
 Note that the following examples assume `client` is the name of your `poe.Client` instance. If the token is invalid, a RuntimeError will be raised.
 
 #### Downloading the Available Bots:
 The client downloads all of the available bots upon initialization and stores them within `client.bots`. A dictionary that maps bot codenames to their display names can be found at `client.bot_names`. If you want to refresh these values, you can call `client.get_bots`. This function takes the following arguments:
- - `download_next_data = True` - Whether or not to redownload the `__NEXT_DATA__`, which is required if the bot list has changed. 
+ - `download_next_data = True` - Whether or not to re-download the `__NEXT_DATA__`, which is required if the bot list has changed. 
 
 ```python
-print(client.bot_names)
-#{'capybara': 'Sage', 'beaver': 'GPT-4', 'a2_2': 'Claude+', 'a2': 'Claude', 'chinchilla': 'ChatGPT', 'nutria': 'Dragonfly'}
+print(json.dumps(client.bot_names, indent=2))
+"""
+{
+  "capybara": "Sage",
+  "a2": "Claude-instant",
+  "nutria": "Dragonfly",
+  "a2_100k": "Claude-instant-100k",
+  "beaver": "GPT-4",
+  "chinchilla": "ChatGPT",
+  "a2_2": "Claude+"
+}
+"""
+```
+
+Note that, on free accounts, Claude+ (a2_2) has a limit of 3 messages per day and GPT-4 (beaver) has a limit of 1 message per day. Claude-instant-100k (c2_100k) is completely inaccessible for free accounts. For all the other chatbots, there seems to be a rate limit of 10 messages per minute.
+
+#### Using 3rd Party Bots
+To get a list of 3rd party bots, use `client.explore_bots`, which accepts the following arguments:
+ - `end_cursor = None` - The cursor to use when fetching the list. 
+ - `count = 25` - The number of bots that is returned.
+
+The function will return a dict containing a list of bots and the cursor for the next page:
+```python
+print(json.dumps(client.explore_bots(count=1), indent=2))
+"""
+{
+  "bots": [
+    {
+      "id": "Qm90OjEwMzI2MDI=",
+      "displayName": "leocooks",
+      "deletionState": "not_deleted",
+      "image": {
+        "__typename": "UrlBotImage",
+        "url": "https://qph.cf2.quoracdn.net/main-thumb-pb-1032602-200-uorvomwowfgmatdvrtwajtwwqlujmmgu.jpeg"
+      },
+      "botId": 1032602,
+      "followerCount": 1922,
+      "description": "Above average meals for average cooks, made simple by world-renowned chef, Leonardo",
+      "__typename": "Bot"
+    }
+  ],
+  "end_cursor": "1000172"
+}
+"""
 ```
 
-Note that, on free accounts, Claude+ (a2_2) has a limit of 3 messages per day and GPT-4 (beaver) has a limit of 1 message per day. For all the other chatbots, there seems to be a rate limit of 10 messages per minute.
+Since display names are the same as the codenames for custom bots, you can simply pass the bot's display name into `client.send_message` to send it a message.
 
 #### Creating New Bots:
 You can create a new bot using the `client.create_bot` function, which accepts the following arguments:
  - `handle` - The handle of the new bot.
  - `prompt = ""` - The prompt for the new bot.
  - `base_model = "chinchilla"` - The model that the new bot uses. This must be either `"chinchilla"` (ChatGPT)  or `"a2"` (Claude).
  - `description = ""` - The description for the new bot.
@@ -112,15 +160,15 @@
  - `prompt_public = True` - Whether or not the prompt should be publicly visible. 
  - `pfp_url = None` - The URL for the bot's profile picture. Currently, there is no way to actually upload a custom image using this library.
  - `linkification = False` - Whether or not the bot should turn some text in the response into clickable links.
  - `markdown_rendering = True` - Whether or not to enable markdown rendering for the bot's responses.
  - `suggested_replies = False` - Whether or not the bot should suggest possible replies after each response.
  - `private = False` - Whether or not the bot should be private.
 
-Additionally, there are some arguments that seem to be for the upcoming bot developer API. You do not need to specify these, although they may become useful in the future. The description for these arguments are currently my best guesses for what they do:
+Use these arguments if you want the new bot to use your own API (as detailed [here](https://github.com/poe-platform/api-bot-tutorial)):
  - `api_key = None` - The API key for the new bot. 
  - `api_bot = False` - Whether or not the bot has API functionally enabled.
  - `api_url = None` - The API URL for the new bot.
 
 A full example of how to create and edit bots is located at `examples/create_bot.py`.
 ```python
 new_bot = client.create_bot(bot_name, "prompt goes here", base_model="a2")
@@ -137,15 +185,15 @@
  - `prompt_public = True` - Whether or not the prompt should be publicly visible. 
  - `pfp_url = None` - The URL for the bot's profile picture. Currently, there is no way to actually upload a custom image using this library.
  - `linkification = False` - Whether or not the bot should turn some text in the response into clickable links.
  - `markdown_rendering = True` - Whether or not to enable markdown rendering for the bot's responses.
  - `suggested_replies = False` - Whether or not the bot should suggest possible replies after each response.
  - `private = False` - Whether or not the bot should be private.
 
-Unreleased bot developer API arguments:
+Bot API related arguments:
  - `api_key = None` - The new API key for the bot. 
  - `api_url = None` - The new API URL for the bot.
 
 A full example of how to create and edit bots is located at `examples/create_bot.py`.
 ```python
 edit_result = client.edit_bot(1086981, "bot_handle_here", base_model="beaver")
 ```
@@ -170,15 +218,15 @@
 ```python
 message = "Summarize the GNU GPL v3"
 for chunk in client.send_message("capybara", message):
   pass
 print(chunk["text"])
 ```
 
-You can also send multiple messages in parallel using `threading` and recieve their responses seperately, as demonstrated in `/examples/parallel_messages.py`. Note that if you send messages too fast, the server will give an error, but the request will eventually succeed.
+You can also send multiple messages in parallel using `threading` and receive their responses separately, as demonstrated in `/examples/parallel_messages.py`. Note that if you send messages too fast, the server will give an error, but the request will eventually succeed.
 
 #### Clearing the Conversation Context:
 If you want to clear the the context of a conversation without sending a message, you can use `client.send_chat_break`. The only argument is the codename of the bot whose context will be cleared.
 
 ```python
 client.send_chat_break("capybara")
 ```
@@ -287,21 +335,34 @@
   "Sec-Fetch-Mode": "cors",
   "Sec-Fetch-Site": "same-origin"
 }
 ```
 
 Previously, this was done through `poe.user_agent`, but that variable is now completely ignored.
 
+You'd also want to change `poe.client_identifier` to match the user-agent that you have set. See the [Python-TLS-Client documentation](https://github.com/FlorianREGAZ/Python-Tls-Client#examples) for some examples.
+
+### Setting a Custom Device ID:
+If you want to change the device ID that is being spoofed, you can use the `poe.set_device_id`, which accepts the following arguments:
+ - `user_id` - The user ID of the account you want to change the device ID for.
+ - `device_id` - The new device ID. This is a standard 32 character UUID string.
+
+The device IDs are saved to `~/.config/poe-api/device_id.json` on Unix-like systems, and `C:\Users\<user>\AppData\Roaming\poe-api\device_id.json` on Windows.
+
+Additionally, the `poe.get_device_id` function or `client.device_id` can be used to retrieve the saved device ID.
+
 ## Copyright: 
 This program is licensed under the [GNU GPL v3](https://www.gnu.org/licenses/gpl-3.0.txt). Most code, with the exception of the GraphQL queries, has been written by me, [ading2210](https://github.com/ading2210).
 
 Reverse engineering the `poe-tag-id` header has been done by [xtekky](https://github.com/xtekky) in [PR #39](https://github.com/ading2210/poe-api/pull/39).
 
 The `client.get_remaining_messages` function was written by [Snowad14](https://github.com/Snowad14) in [PR #46](https://github.com/ading2210/poe-api/pull/46).
 
+Detection avoidance and fetching the third party bots has been done by [acheong08](https://github.com/acheong08/) in [PR #79](https://github.com/ading2210/poe-api/pull/79).
+
 Most of the GraphQL queries are taken from [muharamdani/poe](https://github.com/muharamdani/poe), which is licenced under the ISC License. 
 
 ### Copyright Notice:
 ```
 ading2210/poe-api: a reverse engineered Python API wrapepr for Quora's Poe
 Copyright (C) 2023 ading2210
```

## Comparing `poe_api-0.3.1.dist-info/RECORD` & `poe_api-0.4.0.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,19 +1,20 @@
-poe.py,sha256=ue5A8T9gys7Lf21wlnt6yrxc8bkX8X_nG7zA9JN2Zn4,16891
+poe.py,sha256=6wxy5KVw_Pon-cL2Jm0X8U6FbO8st9o37mlD0qoQDXA,19184
 poe_graphql/AddHumanMessageMutation.graphql,sha256=Va4SoysKE2qPlJfbwoKp6mNv0vs5hnVR20g8hPvAxdY,1093
 poe_graphql/AddMessageBreakMutation.graphql,sha256=0XrqSAgAkG5vCFwBALRpoAgUDSFM9XUB5wBy5Iou9c8,373
 poe_graphql/AutoSubscriptionMutation.graphql,sha256=3i8EnqwUrjOcJ2Hxly-lKhwPBJdbpO99POiM_K6jVD4,180
 poe_graphql/BioFragment.graphql,sha256=3ZdXaPtuHK38bG10WFH6bvpebcyrTLu5fs-ddtfLjf0,97
 poe_graphql/ChatAddedSubscription.graphql,sha256=NFLZJAwi0V2WQea1oelyRUrtNrwOE58NOeX8ChzVE10,73
 poe_graphql/ChatFragment.graphql,sha256=NFVSvT3NdYlEquue3yTHPu9ezCIgx6k1OXJZo2ytIzU,100
 poe_graphql/ChatListPaginationQuery.graphql,sha256=-jtpUwcHsF8nEXQcxLe9gFycYuKRVDBjGNFiH-nPL98,6971
 poe_graphql/ChatPaginationQuery.graphql,sha256=YKhwFvGp4X41ujHC1ZftD2DTJ0qZtDcMGbsJUoc4MzA,686
 poe_graphql/ChatViewQuery.graphql,sha256=EQZuiR4EydYgtRiUgdbo-Do7fKf9XYM1bPZT0wydj68,154
 poe_graphql/DeleteHumanMessagesMutation.graphql,sha256=-k8JLKkaIfyI0TEtcgJxLIjIEIZCovXiKpRQKV_sp0o,160
 poe_graphql/DeleteMessageMutation.graphql,sha256=KFjDa2lm9kDOZyE5Y9PDa57IDY9QedFUCWMOHjhNTIs,123
+poe_graphql/ExploreBotsListPaginationQuery.graphql,sha256=OD0plioAlk5qwItyN55kOHZCvo6PCbw-FNfNAmaM7Fs,1083
 poe_graphql/HandleFragment.graphql,sha256=wpz7h-BSGEHKBVmYoW8rMvooIUh4_vOCrQRV9Kql0R4,103
 poe_graphql/LoginWithVerificationCodeMutation.graphql,sha256=9y_wjqw7ZyZaBjFVDMAplbM-5Vb40XBxadZe_Z87Pr8,306
 poe_graphql/MessageAddedSubscription.graphql,sha256=Qo_eRYWDfpe-xzv-uO3cAchQR-WeOSWtutbPXErQAj0,1885
 poe_graphql/MessageDeletedSubscription.graphql,sha256=bdNXMzFrGQHtTv2JzYKTJOIFcaz27Lo5d2RN2_RJGEE,135
 poe_graphql/MessageFragment.graphql,sha256=QWCsaU9FqTEjfNrvRjPJXbkLi6cjl5Y-O4_0SZ6Wvwc,194
 poe_graphql/MessageRemoveVoteMutation.graphql,sha256=IfvP0tYtgx_UHgzdMn2R6H3gA9jQCR5xnhxy5uTJH9M,145
 poe_graphql/MessageSetVoteMutation.graphql,sha256=TJ3fVmQ9VwVDLeRFD8NbzOGZ4qhb6nSlqwi8FzTaKCQ,216
@@ -29,12 +30,12 @@
 poe_graphql/SummarizeQuotePostQuery.graphql,sha256=V4PQ1XkEDCsVR3z7h4SLsonZsWG7RptFd6JPwlGwOvE,147
 poe_graphql/SummarizeSharePostQuery.graphql,sha256=iCN8oiUUp2jfsiBxmsTA7k3_60E0MNwA5gnNrhnYpJc,180
 poe_graphql/UserSnippetFragment.graphql,sha256=Eg8rK7XM6-HqVJkpEBY0bJaYqF-FdDdWdg-Jj3VTnF0,368
 poe_graphql/ViewerInfoQuery.graphql,sha256=Xtn-VGGiknKgrW81s7YfIJwhmilobrSqiCObpoJdYfw,400
 poe_graphql/ViewerStateFragment.graphql,sha256=aicUJncsRpPBh_L2xqDv0aHcUIPIsDrDFPfDs3jcFoU,1038
 poe_graphql/ViewerStateUpdatedSubscription.graphql,sha256=1dPs0WuOLl4ybZXm4bUF60eVc94O10EkKOtqnQYODic,657
 poe_graphql/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-poe_api-0.3.1.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
-poe_api-0.3.1.dist-info/METADATA,sha256=m657xYNo5rqJBG7s-N5qQcoqePidrcpZyb80Cc2sbeg,14177
-poe_api-0.3.1.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
-poe_api-0.3.1.dist-info/top_level.txt,sha256=7Sk_jA5I5n3fNZ1671pcBau4TWZLe6UXCEnCD5NhGGI,16
-poe_api-0.3.1.dist-info/RECORD,,
+poe_api-0.4.0.dist-info/LICENSE,sha256=OXLcl0T2SZ8Pmy2_dmlvKuetivmyPd5m1q-Gyd-zaYY,35149
+poe_api-0.4.0.dist-info/METADATA,sha256=_dHhhhIPAmBaim6Pr2aa0p3HnFa32Hsl9ChTFHYOpS8,16887
+poe_api-0.4.0.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
+poe_api-0.4.0.dist-info/top_level.txt,sha256=7Sk_jA5I5n3fNZ1671pcBau4TWZLe6UXCEnCD5NhGGI,16
+poe_api-0.4.0.dist-info/RECORD,,
```

